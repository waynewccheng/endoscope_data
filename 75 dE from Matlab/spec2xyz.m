function [X Y Z xx yy zz] = spec2xyz (s)
% CIEXYZ 1931
cmf1nm = [
    380.0 0.001368 0.000039 0.006450;
    381.0 0.001502 0.000043 0.007083;
    382.0 0.001642 0.000047 0.007745;
    383.0 0.001802 0.000052 0.008501;
    384.0 0.001996 0.000057 0.009415;
    385.0 0.002236 0.000064 0.010550;
    386.0 0.002535 0.000072 0.011966;
    387.0 0.002893 0.000082 0.013656;
    388.0 0.003301 0.000094 0.015588;
    389.0 0.003753 0.000106 0.017730;
    390.0 0.004243 0.000120 0.020050;
    391.0 0.004762 0.000135 0.022511;
    392.0 0.005330 0.000151 0.025203;
    393.0 0.005979 0.000170 0.028280;
    394.0 0.006741 0.000192 0.031897;
    395.0 0.007650 0.000217 0.036210;
    396.0 0.008751 0.000247 0.041438;
    397.0 0.010029 0.000281 0.047504;
    398.0 0.011422 0.000319 0.054120;
    399.0 0.012869 0.000357 0.060998;
    400.0 0.014310 0.000396 0.067850;
    401.0 0.015704 0.000434 0.074486;
    402.0 0.017147 0.000473 0.081362;
    403.0 0.018781 0.000518 0.089154;
    404.0 0.020748 0.000572 0.098540;
    405.0 0.023190 0.000640 0.110200;
    406.0 0.026207 0.000725 0.124613;
    407.0 0.029782 0.000825 0.141702;
    408.0 0.033881 0.000941 0.161303;
    409.0 0.038468 0.001070 0.183257;
    410.0 0.043510 0.001210 0.207400;
    411.0 0.048996 0.001362 0.233692;
    412.0 0.055023 0.001531 0.262611;
    413.0 0.061719 0.001720 0.294775;
    414.0 0.069212 0.001935 0.330799;
    415.0 0.077630 0.002180 0.371300;
    416.0 0.086958 0.002455 0.416209;
    417.0 0.097177 0.002764 0.465464;
    418.0 0.108406 0.003118 0.519695;
    419.0 0.120767 0.003526 0.579530;
    420.0 0.134380 0.004000 0.645600;
    421.0 0.149358 0.004546 0.718484;
    422.0 0.165396 0.005159 0.796713;
    423.0 0.181983 0.005829 0.877846;
    424.0 0.198611 0.006546 0.959439;
    425.0 0.214770 0.007300 1.039050;
    426.0 0.230187 0.008087 1.115367;
    427.0 0.244880 0.008909 1.188497;
    428.0 0.258777 0.009768 1.258123;
    429.0 0.271808 0.010664 1.323930;
    430.0 0.283900 0.011600 1.385600;
    431.0 0.294944 0.012573 1.442635;
    432.0 0.304897 0.013583 1.494804;
    433.0 0.313787 0.014630 1.542190;
    434.0 0.321645 0.015715 1.584881;
    435.0 0.328500 0.016840 1.622960;
    436.0 0.334351 0.018007 1.656405;
    437.0 0.339210 0.019214 1.685296;
    438.0 0.343121 0.020454 1.709875;
    439.0 0.346130 0.021718 1.730382;
    440.0 0.348280 0.023000 1.747060;
    441.0 0.349600 0.024295 1.760045;
    442.0 0.350147 0.025610 1.769623;
    443.0 0.350013 0.026959 1.776264;
    444.0 0.349287 0.028351 1.780433;
    445.0 0.348060 0.029800 1.782600;
    446.0 0.346373 0.031311 1.782968;
    447.0 0.344262 0.032884 1.781700;
    448.0 0.341809 0.034521 1.779198;
    449.0 0.339094 0.036226 1.775867;
    450.0 0.336200 0.038000 1.772110;
    451.0 0.333198 0.039847 1.768259;
    452.0 0.330041 0.041768 1.764039;
    453.0 0.326636 0.043766 1.758944;
    454.0 0.322887 0.045843 1.752466;
    455.0 0.318700 0.048000 1.744100;
    456.0 0.314025 0.050244 1.733559;
    457.0 0.308884 0.052573 1.720858;
    458.0 0.303290 0.054981 1.705937;
    459.0 0.297258 0.057459 1.688737;
    460.0 0.290800 0.060000 1.669200;
    461.0 0.283970 0.062602 1.647529;
    462.0 0.276721 0.065278 1.623413;
    463.0 0.268918 0.068042 1.596022;
    464.0 0.260423 0.070911 1.564528;
    465.0 0.251100 0.073900 1.528100;
    466.0 0.240847 0.077016 1.486111;
    467.0 0.229851 0.080266 1.439521;
    468.0 0.218407 0.083667 1.389880;
    469.0 0.206812 0.087233 1.338736;
    470.0 0.195360 0.090980 1.287640;
    471.0 0.184214 0.094918 1.237422;
    472.0 0.173327 0.099046 1.187824;
    473.0 0.162688 0.103367 1.138761;
    474.0 0.152283 0.107885 1.090148;
    475.0 0.142100 0.112600 1.041900;
    476.0 0.132179 0.117532 0.994198;
    477.0 0.122570 0.122674 0.947347;
    478.0 0.113275 0.127993 0.901453;
    479.0 0.104298 0.133453 0.856619;
    480.0 0.095640 0.139020 0.812950;
    481.0 0.087300 0.144676 0.770517;
    482.0 0.079308 0.150469 0.729445;
    483.0 0.071718 0.156462 0.689914;
    484.0 0.064581 0.162718 0.652105;
    485.0 0.057950 0.169300 0.616200;
    486.0 0.051862 0.176243 0.582329;
    487.0 0.046282 0.183558 0.550416;
    488.0 0.041151 0.191274 0.520338;
    489.0 0.036413 0.199418 0.491967;
    490.0 0.032010 0.208020 0.465180;
    491.0 0.027917 0.217120 0.439925;
    492.0 0.024144 0.226735 0.416184;
    493.0 0.020687 0.236857 0.393882;
    494.0 0.017540 0.247481 0.372946;
    495.0 0.014700 0.258600 0.353300;
    496.0 0.012162 0.270185 0.334858;
    497.0 0.009920 0.282294 0.317552;
    498.0 0.007967 0.295050 0.301337;
    499.0 0.006296 0.308578 0.286169;
    500.0 0.004900 0.323000 0.272000;
    501.0 0.003777 0.338402 0.258817;
    502.0 0.002945 0.354686 0.246484;
    503.0 0.002425 0.371699 0.234772;
    504.0 0.002236 0.389288 0.223453;
    505.0 0.002400 0.407300 0.212300;
    506.0 0.002926 0.425630 0.201169;
    507.0 0.003837 0.444310 0.190120;
    508.0 0.005175 0.463394 0.179225;
    509.0 0.006982 0.482940 0.168561;
    510.0 0.009300 0.503000 0.158200;
    511.0 0.012149 0.523569 0.148138;
    512.0 0.015536 0.544512 0.138376;
    513.0 0.019478 0.565690 0.128994;
    514.0 0.023993 0.586965 0.120075;
    515.0 0.029100 0.608200 0.111700;
    516.0 0.034815 0.629346 0.103905;
    517.0 0.041120 0.650307 0.096667;
    518.0 0.047985 0.670875 0.089983;
    519.0 0.055379 0.690842 0.083845;
    520.0 0.063270 0.710000 0.078250;
    521.0 0.071635 0.728185 0.073209;
    522.0 0.080462 0.745464 0.068678;
    523.0 0.089740 0.761969 0.064568;
    524.0 0.099456 0.777837 0.060788;
    525.0 0.109600 0.793200 0.057250;
    526.0 0.120167 0.808110 0.053904;
    527.0 0.131114 0.822496 0.050747;
    528.0 0.142368 0.836307 0.047753;
    529.0 0.153854 0.849492 0.044899;
    530.0 0.165500 0.862000 0.042160;
    531.0 0.177257 0.873811 0.039507;
    532.0 0.189140 0.884962 0.036936;
    533.0 0.201169 0.895494 0.034458;
    534.0 0.213366 0.905443 0.032089;
    535.0 0.225750 0.914850 0.029840;
    536.0 0.238321 0.923735 0.027712;
    537.0 0.251067 0.932092 0.025694;
    538.0 0.263992 0.939923 0.023787;
    539.0 0.277102 0.947225 0.021989;
    540.0 0.290400 0.954000 0.020300;
    541.0 0.303891 0.960256 0.018718;
    542.0 0.317573 0.966007 0.017240;
    543.0 0.331438 0.971261 0.015864;
    544.0 0.345483 0.976023 0.014585;
    545.0 0.359700 0.980300 0.013400;
    546.0 0.374084 0.984092 0.012307;
    547.0 0.388640 0.987418 0.011302;
    548.0 0.403378 0.990313 0.010378;
    549.0 0.418312 0.992812 0.009529;
    550.0 0.433450 0.994950 0.008750;
    551.0 0.448795 0.996711 0.008035;
    552.0 0.464336 0.998098 0.007382;
    553.0 0.480064 0.999112 0.006785;
    554.0 0.495971 0.999748 0.006243;
    555.0 0.512050 1.000000 0.005750;
    556.0 0.528296 0.999857 0.005304;
    557.0 0.544692 0.999305 0.004900;
    558.0 0.561209 0.998325 0.004534;
    559.0 0.577821 0.996899 0.004202;
    560.0 0.594500 0.995000 0.003900;
    561.0 0.611221 0.992601 0.003623;
    562.0 0.627976 0.989743 0.003371;
    563.0 0.644760 0.986444 0.003141;
    564.0 0.661570 0.982724 0.002935;
    565.0 0.678400 0.978600 0.002750;
    566.0 0.695239 0.974084 0.002585;
    567.0 0.712059 0.969171 0.002439;
    568.0 0.728828 0.963857 0.002309;
    569.0 0.745519 0.958135 0.002197;
    570.0 0.762100 0.952000 0.002100;
    571.0 0.778543 0.945450 0.002018;
    572.0 0.794826 0.938499 0.001948;
    573.0 0.810926 0.931163 0.001890;
    574.0 0.826825 0.923458 0.001841;
    575.0 0.842500 0.915400 0.001800;
    576.0 0.857932 0.907006 0.001766;
    577.0 0.873082 0.898277 0.001738;
    578.0 0.887894 0.889205 0.001711;
    579.0 0.902318 0.879782 0.001683;
    580.0 0.916300 0.870000 0.001650;
    581.0 0.929800 0.859861 0.001610;
    582.0 0.942798 0.849392 0.001564;
    583.0 0.955278 0.838622 0.001514;
    584.0 0.967218 0.827581 0.001459;
    585.0 0.978600 0.816300 0.001400;
    586.0 0.989386 0.804795 0.001337;
    587.0 0.999549 0.793082 0.001270;
    588.0 1.009089 0.781192 0.001205;
    589.0 1.018006 0.769155 0.001147;
    590.0 1.026300 0.757000 0.001100;
    591.0 1.033983 0.744754 0.001069;
    592.0 1.040986 0.732422 0.001049;
    593.0 1.047188 0.720004 0.001036;
    594.0 1.052467 0.707496 0.001021;
    595.0 1.056700 0.694900 0.001000;
    596.0 1.059794 0.682219 0.000969;
    597.0 1.061799 0.669472 0.000930;
    598.0 1.062807 0.656674 0.000887;
    599.0 1.062910 0.643845 0.000843;
    600.0 1.062200 0.631000 0.000800;
    601.0 1.060735 0.618155 0.000761;
    602.0 1.058444 0.605314 0.000724;
    603.0 1.055224 0.592476 0.000686;
    604.0 1.050977 0.579638 0.000645;
    605.0 1.045600 0.566800 0.000600;
    606.0 1.039037 0.553961 0.000548;
    607.0 1.031361 0.541137 0.000492;
    608.0 1.022666 0.528353 0.000435;
    609.0 1.013048 0.515632 0.000383;
    610.0 1.002600 0.503000 0.000340;
    611.0 0.991367 0.490469 0.000307;
    612.0 0.979331 0.478030 0.000283;
    613.0 0.966492 0.465678 0.000265;
    614.0 0.952848 0.453403 0.000252;
    615.0 0.938400 0.441200 0.000240;
    616.0 0.923194 0.429080 0.000230;
    617.0 0.907244 0.417036 0.000221;
    618.0 0.890502 0.405032 0.000212;
    619.0 0.872920 0.393032 0.000202;
    620.0 0.854450 0.381000 0.000190;
    621.0 0.835084 0.368918 0.000174;
    622.0 0.814946 0.356827 0.000156;
    623.0 0.794186 0.344777 0.000136;
    624.0 0.772954 0.332818 0.000117;
    625.0 0.751400 0.321000 0.000100;
    626.0 0.729584 0.309338 0.000086;
    627.0 0.707589 0.297850 0.000075;
    628.0 0.685602 0.286594 0.000065;
    629.0 0.663810 0.275624 0.000057;
    630.0 0.642400 0.265000 0.000050;
    631.0 0.621515 0.254763 0.000044;
    632.0 0.601114 0.244890 0.000039;
    633.0 0.581105 0.235334 0.000036;
    634.0 0.561398 0.226053 0.000033;
    635.0 0.541900 0.217000 0.000030;
    636.0 0.522599 0.208162 0.000028;
    637.0 0.503546 0.199549 0.000026;
    638.0 0.484744 0.191155 0.000024;
    639.0 0.466194 0.182974 0.000022;
    640.0 0.447900 0.175000 0.000020;
    641.0 0.429861 0.167224 0.000018;
    642.0 0.412098 0.159646 0.000016;
    643.0 0.394644 0.152278 0.000014;
    644.0 0.377533 0.145126 0.000012;
    645.0 0.360800 0.138200 0.000010;
    646.0 0.344456 0.131500 0.000008;
    647.0 0.328517 0.125025 0.000005;
    648.0 0.313019 0.118779 0.000003;
    649.0 0.298001 0.112769 0.000001;
    650.0 0.283500 0.107000 0.000000;
    651.0 0.269545 0.101476 0.000000;
    652.0 0.256118 0.096189 0.000000;
    653.0 0.243190 0.091123 0.000000;
    654.0 0.230727 0.086265 0.000000;
    655.0 0.218700 0.081600 0.000000;
    656.0 0.207097 0.077121 0.000000;
    657.0 0.195923 0.072826 0.000000;
    658.0 0.185171 0.068710 0.000000;
    659.0 0.174832 0.064770 0.000000;
    660.0 0.164900 0.061000 0.000000;
    661.0 0.155367 0.057396 0.000000;
    662.0 0.146230 0.053955 0.000000;
    663.0 0.137490 0.050674 0.000000;
    664.0 0.129147 0.047550 0.000000;
    665.0 0.121200 0.044580 0.000000;
    666.0 0.113640 0.041759 0.000000;
    667.0 0.106465 0.039085 0.000000;
    668.0 0.099690 0.036564 0.000000;
    669.0 0.093331 0.034200 0.000000;
    670.0 0.087400 0.032000 0.000000;
    671.0 0.081901 0.029963 0.000000;
    672.0 0.076804 0.028077 0.000000;
    673.0 0.072077 0.026329 0.000000;
    674.0 0.067687 0.024708 0.000000;
    675.0 0.063600 0.023200 0.000000;
    676.0 0.059807 0.021801 0.000000;
    677.0 0.056282 0.020501 0.000000;
    678.0 0.052971 0.019281 0.000000;
    679.0 0.049819 0.018121 0.000000;
    680.0 0.046770 0.017000 0.000000;
    681.0 0.043784 0.015904 0.000000;
    682.0 0.040875 0.014837 0.000000;
    683.0 0.038073 0.013811 0.000000;
    684.0 0.035405 0.012835 0.000000;
    685.0 0.032900 0.011920 0.000000;
    686.0 0.030564 0.011068 0.000000;
    687.0 0.028381 0.010273 0.000000;
    688.0 0.026345 0.009533 0.000000;
    689.0 0.024453 0.008846 0.000000;
    690.0 0.022700 0.008210 0.000000;
    691.0 0.021084 0.007624 0.000000;
    692.0 0.019600 0.007085 0.000000;
    693.0 0.018237 0.006591 0.000000;
    694.0 0.016987 0.006138 0.000000;
    695.0 0.015840 0.005723 0.000000;
    696.0 0.014791 0.005343 0.000000;
    697.0 0.013831 0.004996 0.000000;
    698.0 0.012949 0.004676 0.000000;
    699.0 0.012129 0.004380 0.000000;
    700.0 0.011359 0.004102 0.000000;
    701.0 0.010629 0.003838 0.000000;
    702.0 0.009939 0.003589 0.000000;
    703.0 0.009288 0.003354 0.000000;
    704.0 0.008679 0.003134 0.000000;
    705.0 0.008111 0.002929 0.000000;
    706.0 0.007582 0.002738 0.000000;
    707.0 0.007089 0.002560 0.000000;
    708.0 0.006627 0.002393 0.000000;
    709.0 0.006195 0.002237 0.000000;
    710.0 0.005790 0.002091 0.000000;
    711.0 0.005410 0.001954 0.000000;
    712.0 0.005053 0.001825 0.000000;
    713.0 0.004718 0.001704 0.000000;
    714.0 0.004404 0.001590 0.000000;
    715.0 0.004109 0.001484 0.000000;
    716.0 0.003834 0.001384 0.000000;
    717.0 0.003576 0.001291 0.000000;
    718.0 0.003334 0.001204 0.000000;
    719.0 0.003109 0.001123 0.000000;
    720.0 0.002899 0.001047 0.000000;
    721.0 0.002704 0.000977 0.000000;
    722.0 0.002523 0.000911 0.000000;
    723.0 0.002354 0.000850 0.000000;
    724.0 0.002197 0.000793 0.000000;
    725.0 0.002049 0.000740 0.000000;
    726.0 0.001911 0.000690 0.000000;
    727.0 0.001781 0.000643 0.000000;
    728.0 0.001660 0.000599 0.000000;
    729.0 0.001546 0.000558 0.000000;
    730.0 0.001440 0.000520 0.000000;
    731.0 0.001340 0.000484 0.000000;
    732.0 0.001246 0.000450 0.000000;
    733.0 0.001158 0.000418 0.000000;
    734.0 0.001076 0.000389 0.000000;
    735.0 0.001000 0.000361 0.000000;
    736.0 0.000929 0.000335 0.000000;
    737.0 0.000862 0.000311 0.000000;
    738.0 0.000801 0.000289 0.000000;
    739.0 0.000743 0.000268 0.000000;
    740.0 0.000690 0.000249 0.000000;
    741.0 0.000641 0.000231 0.000000;
    742.0 0.000595 0.000215 0.000000;
    743.0 0.000552 0.000199 0.000000;
    744.0 0.000512 0.000185 0.000000;
    745.0 0.000476 0.000172 0.000000;
    746.0 0.000442 0.000160 0.000000;
    747.0 0.000412 0.000149 0.000000;
    748.0 0.000383 0.000138 0.000000;
    749.0 0.000357 0.000129 0.000000;
    750.0 0.000332 0.000120 0.000000;
    751.0 0.000310 0.000112 0.000000;
    752.0 0.000289 0.000104 0.000000;
    753.0 0.000270 0.000097 0.000000;
    754.0 0.000252 0.000091 0.000000;
    755.0 0.000235 0.000085 0.000000;
    756.0 0.000219 0.000079 0.000000;
    757.0 0.000205 0.000074 0.000000;
    758.0 0.000191 0.000069 0.000000;
    759.0 0.000178 0.000064 0.000000;
    760.0 0.000166 0.000060 0.000000;
    761.0 0.000155 0.000056 0.000000;
    762.0 0.000145 0.000052 0.000000;
    763.0 0.000135 0.000049 0.000000;
    764.0 0.000126 0.000045 0.000000;
    765.0 0.000117 0.000042 0.000000;
    766.0 0.000110 0.000040 0.000000;
    767.0 0.000102 0.000037 0.000000;
    768.0 0.000095 0.000034 0.000000;
    769.0 0.000089 0.000032 0.000000;
    770.0 0.000083 0.000030 0.000000;
    771.0 0.000078 0.000028 0.000000;
    772.0 0.000072 0.000026 0.000000;
    773.0 0.000067 0.000024 0.000000;
    774.0 0.000063 0.000023 0.000000;
    775.0 0.000059 0.000021 0.000000;
    776.0 0.000055 0.000020 0.000000;
    777.0 0.000051 0.000018 0.000000;
    778.0 0.000048 0.000017 0.000000;
    779.0 0.000044 0.000016 0.000000;
    780.0 0.000042 0.000015 0.000000;
    ];

% CIEXYZ 1964
cmf19641nm = [
    380.0 0.000160 0.000017 0.000705;
    381.0 0.000215 0.000023 0.000948;
    382.0 0.000287 0.000031 0.001268;
    383.0 0.000382 0.000041 0.001686;
    384.0 0.000505 0.000055 0.002229;
    385.0 0.000662 0.000072 0.002928;
    386.0 0.000865 0.000093 0.003824;
    387.0 0.001122 0.000121 0.004964;
    388.0 0.001446 0.000156 0.006407;
    389.0 0.001854 0.000199 0.008219;
    390.0 0.002362 0.000253 0.010482;
    391.0 0.002991 0.000320 0.013289;
    392.0 0.003765 0.000402 0.016747;
    393.0 0.004710 0.000502 0.020980;
    394.0 0.005858 0.000623 0.026127;
    395.0 0.007242 0.000768 0.032344;
    396.0 0.008900 0.000942 0.039802;
    397.0 0.010871 0.001148 0.048691;
    398.0 0.013199 0.001390 0.059210;
    399.0 0.015929 0.001674 0.071576;
    400.0 0.019110 0.002004 0.086011;
    401.0 0.022788 0.002386 0.102740;
    402.0 0.027011 0.002822 0.122000;
    403.0 0.031829 0.003319 0.144020;
    404.0 0.037278 0.003880 0.168990;
    405.0 0.043400 0.004509 0.197120;
    406.0 0.050223 0.005209 0.228570;
    407.0 0.057764 0.005985 0.263470;
    408.0 0.066038 0.006833 0.301900;
    409.0 0.075033 0.007757 0.343870;
    410.0 0.084736 0.008756 0.389366;
    411.0 0.095041 0.009816 0.437970;
    412.0 0.105836 0.010918 0.489220;
    413.0 0.117066 0.012058 0.542900;
    414.0 0.128682 0.013237 0.598810;
    415.0 0.140638 0.014456 0.656760;
    416.0 0.152893 0.015717 0.716580;
    417.0 0.165416 0.017025 0.778120;
    418.0 0.178191 0.018399 0.841310;
    419.0 0.191214 0.019848 0.906110;
    420.0 0.204492 0.021391 0.972542;
    421.0 0.217650 0.022992 1.038900;
    422.0 0.230267 0.024598 1.103100;
    423.0 0.242311 0.026213 1.165100;
    424.0 0.253793 0.027841 1.224900;
    425.0 0.264737 0.029497 1.282500;
    426.0 0.275195 0.031195 1.338200;
    427.0 0.285301 0.032927 1.392600;
    428.0 0.295143 0.034738 1.446100;
    429.0 0.304869 0.036654 1.499400;
    430.0 0.314679 0.038676 1.553480;
    431.0 0.324355 0.040792 1.607200;
    432.0 0.333570 0.042946 1.658900;
    433.0 0.342243 0.045114 1.708200;
    434.0 0.350312 0.047333 1.754800;
    435.0 0.357719 0.049602 1.798500;
    436.0 0.364482 0.051934 1.839200;
    437.0 0.370493 0.054337 1.876600;
    438.0 0.375727 0.056822 1.910500;
    439.0 0.380158 0.059399 1.940800;
    440.0 0.383734 0.062077 1.967280;
    441.0 0.386327 0.064737 1.989100;
    442.0 0.387858 0.067285 2.005700;
    443.0 0.388396 0.069764 2.017400;
    444.0 0.387978 0.072218 2.024400;
    445.0 0.386726 0.074704 2.027300;
    446.0 0.384696 0.077272 2.026400;
    447.0 0.382006 0.079979 2.022300;
    448.0 0.378709 0.082874 2.015300;
    449.0 0.374915 0.086000 2.006000;
    450.0 0.370702 0.089456 1.994800;
    451.0 0.366089 0.092947 1.981400;
    452.0 0.361045 0.096275 1.965300;
    453.0 0.355518 0.099535 1.946400;
    454.0 0.349486 0.102829 1.924800;
    455.0 0.342957 0.106256 1.900700;
    456.0 0.335893 0.109901 1.874100;
    457.0 0.328284 0.113835 1.845100;
    458.0 0.320150 0.118167 1.813900;
    459.0 0.311475 0.122932 1.780600;
    460.0 0.302273 0.128201 1.745370;
    461.0 0.292858 0.133457 1.709100;
    462.0 0.283502 0.138323 1.672300;
    463.0 0.274044 0.143042 1.634700;
    464.0 0.264263 0.147787 1.595600;
    465.0 0.254085 0.152761 1.554900;
    466.0 0.243392 0.158102 1.512200;
    467.0 0.232187 0.163941 1.467300;
    468.0 0.220488 0.170362 1.419900;
    469.0 0.208198 0.177425 1.370000;
    470.0 0.195618 0.185190 1.317560;
    471.0 0.183034 0.193025 1.262400;
    472.0 0.170222 0.200313 1.205000;
    473.0 0.157348 0.207156 1.146600;
    474.0 0.144650 0.213644 1.088000;
    475.0 0.132349 0.219940 1.030200;
    476.0 0.120584 0.226170 0.973830;
    477.0 0.109456 0.232467 0.919430;
    478.0 0.099042 0.239025 0.867460;
    479.0 0.089388 0.245997 0.818280;
    480.0 0.080507 0.253589 0.772125;
    481.0 0.072034 0.261876 0.728290;
    482.0 0.063710 0.270643 0.686040;
    483.0 0.055694 0.279645 0.645530;
    484.0 0.048117 0.288694 0.606850;
    485.0 0.041072 0.297665 0.570060;
    486.0 0.034642 0.306469 0.535220;
    487.0 0.028896 0.315035 0.502340;
    488.0 0.023876 0.323335 0.471400;
    489.0 0.019628 0.331366 0.442390;
    490.0 0.016172 0.339133 0.415254;
    491.0 0.013300 0.347860 0.390024;
    492.0 0.010759 0.358326 0.366399;
    493.0 0.008542 0.370001 0.344015;
    494.0 0.006661 0.382464 0.322689;
    495.0 0.005132 0.395379 0.302356;
    496.0 0.003982 0.408482 0.283036;
    497.0 0.003239 0.421588 0.264816;
    498.0 0.002934 0.434619 0.247848;
    499.0 0.003114 0.447601 0.232318;
    500.0 0.003816 0.460777 0.218502;
    501.0 0.005095 0.474340 0.205851;
    502.0 0.006936 0.488200 0.193596;
    503.0 0.009299 0.502340 0.181736;
    504.0 0.012147 0.516740 0.170281;
    505.0 0.015444 0.531360 0.159249;
    506.0 0.019156 0.546190 0.148673;
    507.0 0.023250 0.561180 0.138609;
    508.0 0.027690 0.576290 0.129096;
    509.0 0.032444 0.591500 0.120215;
    510.0 0.037465 0.606741 0.112044;
    511.0 0.042956 0.622150 0.104710;
    512.0 0.049114 0.637830 0.098196;
    513.0 0.055920 0.653710 0.092361;
    514.0 0.063349 0.669680 0.087088;
    515.0 0.071358 0.685660 0.082248;
    516.0 0.079901 0.701550 0.077744;
    517.0 0.088909 0.717230 0.073456;
    518.0 0.098293 0.732570 0.069268;
    519.0 0.107949 0.747460 0.065060;
    520.0 0.117749 0.761757 0.060709;
    521.0 0.127839 0.775340 0.056457;
    522.0 0.138450 0.788220 0.052609;
    523.0 0.149516 0.800460 0.049122;
    524.0 0.161041 0.812140 0.045954;
    525.0 0.172953 0.823330 0.043050;
    526.0 0.185209 0.834120 0.040368;
    527.0 0.197755 0.844600 0.037839;
    528.0 0.210538 0.854870 0.035384;
    529.0 0.223460 0.865040 0.032949;
    530.0 0.236491 0.875211 0.030451;
    531.0 0.249633 0.885370 0.028029;
    532.0 0.262972 0.895370 0.025862;
    533.0 0.276515 0.905150 0.023920;
    534.0 0.290269 0.914650 0.022174;
    535.0 0.304213 0.923810 0.020584;
    536.0 0.318361 0.932550 0.019127;
    537.0 0.332705 0.940810 0.017740;
    538.0 0.347232 0.948520 0.016403;
    539.0 0.361926 0.955600 0.015064;
    540.0 0.376772 0.961988 0.013676;
    541.0 0.391683 0.967540 0.012308;
    542.0 0.406594 0.972230 0.011056;
    543.0 0.421539 0.976170 0.009915;
    544.0 0.436517 0.979460 0.008872;
    545.0 0.451584 0.982200 0.007918;
    546.0 0.466782 0.984520 0.007030;
    547.0 0.482147 0.986520 0.006223;
    548.0 0.497738 0.988320 0.005453;
    549.0 0.513606 0.990020 0.004714;
    550.0 0.529826 0.991761 0.003988;
    551.0 0.546440 0.993530 0.003289;
    552.0 0.563426 0.995230 0.002646;
    553.0 0.580726 0.996770 0.002063;
    554.0 0.598290 0.998090 0.001533;
    555.0 0.616053 0.999110 0.001091;
    556.0 0.633948 0.999770 0.000711;
    557.0 0.651901 1.000000 0.000407;
    558.0 0.669824 0.999710 0.000184;
    559.0 0.687632 0.998850 0.000047;
    560.0 0.705224 0.997340 0.000000;
    561.0 0.722773 0.995260 0.000000;
    562.0 0.740483 0.992740 0.000000;
    563.0 0.758273 0.989750 0.000000;
    564.0 0.776083 0.986300 0.000000;
    565.0 0.793832 0.982380 0.000000;
    566.0 0.811436 0.977980 0.000000;
    567.0 0.828822 0.973110 0.000000;
    568.0 0.845879 0.967740 0.000000;
    569.0 0.862525 0.961890 0.000000;
    570.0 0.878655 0.955552 0.000000;
    571.0 0.894208 0.948601 0.000000;
    572.0 0.909206 0.940981 0.000000;
    573.0 0.923672 0.932798 0.000000;
    574.0 0.937638 0.924158 0.000000;
    575.0 0.951162 0.915175 0.000000;
    576.0 0.964283 0.905954 0.000000;
    577.0 0.977068 0.896608 0.000000;
    578.0 0.989590 0.887249 0.000000;
    579.0 1.001910 0.877986 0.000000;
    580.0 1.014160 0.868934 0.000000;
    581.0 1.026500 0.860164 0.000000;
    582.0 1.038800 0.851519 0.000000;
    583.0 1.051000 0.842963 0.000000;
    584.0 1.062900 0.834393 0.000000;
    585.0 1.074300 0.825623 0.000000;
    586.0 1.085200 0.816764 0.000000;
    587.0 1.095200 0.807544 0.000000;
    588.0 1.104200 0.797947 0.000000;
    589.0 1.112000 0.787893 0.000000;
    590.0 1.118520 0.777405 0.000000;
    591.0 1.123800 0.766490 0.000000;
    592.0 1.128000 0.755309 0.000000;
    593.0 1.131100 0.743845 0.000000;
    594.0 1.133200 0.732190 0.000000;
    595.0 1.134300 0.720353 0.000000;
    596.0 1.134300 0.708281 0.000000;
    597.0 1.133300 0.696055 0.000000;
    598.0 1.131200 0.683621 0.000000;
    599.0 1.128100 0.671048 0.000000;
    600.0 1.123990 0.658341 0.000000;
    601.0 1.118900 0.645545 0.000000;
    602.0 1.112900 0.632718 0.000000;
    603.0 1.105900 0.619815 0.000000;
    604.0 1.098000 0.606887 0.000000;
    605.0 1.089100 0.593878 0.000000;
    606.0 1.079200 0.580781 0.000000;
    607.0 1.068400 0.567653 0.000000;
    608.0 1.056700 0.554490 0.000000;
    609.0 1.044000 0.541228 0.000000;
    610.0 1.030480 0.527963 0.000000;
    611.0 1.016000 0.514634 0.000000;
    612.0 1.000800 0.501363 0.000000;
    613.0 0.984790 0.488124 0.000000;
    614.0 0.968080 0.474935 0.000000;
    615.0 0.950740 0.461834 0.000000;
    616.0 0.932800 0.448823 0.000000;
    617.0 0.914340 0.435917 0.000000;
    618.0 0.895390 0.423153 0.000000;
    619.0 0.876030 0.410526 0.000000;
    620.0 0.856297 0.398057 0.000000;
    621.0 0.836350 0.385835 0.000000;
    622.0 0.816290 0.373951 0.000000;
    623.0 0.796050 0.362311 0.000000;
    624.0 0.775610 0.350863 0.000000;
    625.0 0.754930 0.339554 0.000000;
    626.0 0.733990 0.328309 0.000000;
    627.0 0.712780 0.317118 0.000000;
    628.0 0.691290 0.305936 0.000000;
    629.0 0.669520 0.294737 0.000000;
    630.0 0.647467 0.283493 0.000000;
    631.0 0.625110 0.272222 0.000000;
    632.0 0.602520 0.260990 0.000000;
    633.0 0.579890 0.249877 0.000000;
    634.0 0.557370 0.238946 0.000000;
    635.0 0.535110 0.228254 0.000000;
    636.0 0.513240 0.217853 0.000000;
    637.0 0.491860 0.207780 0.000000;
    638.0 0.471080 0.198072 0.000000;
    639.0 0.450960 0.188748 0.000000;
    640.0 0.431567 0.179828 0.000000;
    641.0 0.412870 0.171285 0.000000;
    642.0 0.394750 0.163059 0.000000;
    643.0 0.377210 0.155151 0.000000;
    644.0 0.360190 0.147535 0.000000;
    645.0 0.343690 0.140211 0.000000;
    646.0 0.327690 0.133170 0.000000;
    647.0 0.312170 0.126400 0.000000;
    648.0 0.297110 0.119892 0.000000;
    649.0 0.282500 0.113640 0.000000;
    650.0 0.268329 0.107633 0.000000;
    651.0 0.254590 0.101870 0.000000;
    652.0 0.241300 0.096347 0.000000;
    653.0 0.228480 0.091063 0.000000;
    654.0 0.216140 0.086010 0.000000;
    655.0 0.204300 0.081187 0.000000;
    656.0 0.192950 0.076583 0.000000;
    657.0 0.182110 0.072198 0.000000;
    658.0 0.171770 0.068024 0.000000;
    659.0 0.161920 0.064052 0.000000;
    660.0 0.152568 0.060281 0.000000;
    661.0 0.143670 0.056697 0.000000;
    662.0 0.135200 0.053292 0.000000;
    663.0 0.127130 0.050059 0.000000;
    664.0 0.119480 0.046998 0.000000;
    665.0 0.112210 0.044096 0.000000;
    666.0 0.105310 0.041345 0.000000;
    667.0 0.098786 0.038751 0.000000;
    668.0 0.092610 0.036298 0.000000;
    669.0 0.086773 0.033983 0.000000;
    670.0 0.081261 0.031800 0.000000;
    671.0 0.076048 0.029739 0.000000;
    672.0 0.071114 0.027792 0.000000;
    673.0 0.066454 0.025955 0.000000;
    674.0 0.062062 0.024226 0.000000;
    675.0 0.057930 0.022602 0.000000;
    676.0 0.054050 0.021078 0.000000;
    677.0 0.050412 0.019651 0.000000;
    678.0 0.047006 0.018315 0.000000;
    679.0 0.043823 0.017069 0.000000;
    680.0 0.040851 0.015905 0.000000;
    681.0 0.038072 0.014818 0.000000;
    682.0 0.035468 0.013801 0.000000;
    683.0 0.033031 0.012850 0.000000;
    684.0 0.030753 0.011961 0.000000;
    685.0 0.028623 0.011130 0.000000;
    686.0 0.026635 0.010356 0.000000;
    687.0 0.024781 0.009633 0.000000;
    688.0 0.023052 0.008960 0.000000;
    689.0 0.021441 0.008332 0.000000;
    690.0 0.019941 0.007749 0.000000;
    691.0 0.018544 0.007205 0.000000;
    692.0 0.017241 0.006698 0.000000;
    693.0 0.016027 0.006225 0.000000;
    694.0 0.014896 0.005785 0.000000;
    695.0 0.013842 0.005375 0.000000;
    696.0 0.012862 0.004994 0.000000;
    697.0 0.011949 0.004639 0.000000;
    698.0 0.011100 0.004309 0.000000;
    699.0 0.010311 0.004003 0.000000;
    700.0 0.009577 0.003718 0.000000;
    701.0 0.008894 0.003453 0.000000;
    702.0 0.008258 0.003206 0.000000;
    703.0 0.007666 0.002976 0.000000;
    704.0 0.007116 0.002763 0.000000;
    705.0 0.006605 0.002565 0.000000;
    706.0 0.006131 0.002380 0.000000;
    707.0 0.005690 0.002210 0.000000;
    708.0 0.005282 0.002051 0.000000;
    709.0 0.004903 0.001904 0.000000;
    710.0 0.004553 0.001768 0.000000;
    711.0 0.004228 0.001642 0.000000;
    712.0 0.003926 0.001525 0.000000;
    713.0 0.003646 0.001417 0.000000;
    714.0 0.003386 0.001316 0.000000;
    715.0 0.003145 0.001222 0.000000;
    716.0 0.002921 0.001136 0.000000;
    717.0 0.002713 0.001055 0.000000;
    718.0 0.002520 0.000980 0.000000;
    719.0 0.002341 0.000911 0.000000;
    720.0 0.002175 0.000846 0.000000;
    721.0 0.002021 0.000786 0.000000;
    722.0 0.001877 0.000731 0.000000;
    723.0 0.001744 0.000679 0.000000;
    724.0 0.001621 0.000631 0.000000;
    725.0 0.001506 0.000586 0.000000;
    726.0 0.001399 0.000545 0.000000;
    727.0 0.001300 0.000507 0.000000;
    728.0 0.001209 0.000471 0.000000;
    729.0 0.001124 0.000438 0.000000;
    730.0 0.001045 0.000407 0.000000;
    731.0 0.000972 0.000379 0.000000;
    732.0 0.000904 0.000353 0.000000;
    733.0 0.000840 0.000328 0.000000;
    734.0 0.000782 0.000305 0.000000;
    735.0 0.000727 0.000284 0.000000;
    736.0 0.000677 0.000264 0.000000;
    737.0 0.000630 0.000246 0.000000;
    738.0 0.000586 0.000229 0.000000;
    739.0 0.000546 0.000213 0.000000;
    740.0 0.000508 0.000199 0.000000;
    741.0 0.000473 0.000185 0.000000;
    742.0 0.000441 0.000172 0.000000;
    743.0 0.000411 0.000161 0.000000;
    744.0 0.000382 0.000150 0.000000;
    745.0 0.000356 0.000140 0.000000;
    746.0 0.000332 0.000130 0.000000;
    747.0 0.000310 0.000121 0.000000;
    748.0 0.000289 0.000113 0.000000;
    749.0 0.000269 0.000106 0.000000;
    750.0 0.000251 0.000098 0.000000;
    751.0 0.000234 0.000092 0.000000;
    752.0 0.000218 0.000086 0.000000;
    753.0 0.000204 0.000080 0.000000;
    754.0 0.000190 0.000075 0.000000;
    755.0 0.000178 0.000070 0.000000;
    756.0 0.000166 0.000065 0.000000;
    757.0 0.000155 0.000061 0.000000;
    758.0 0.000145 0.000057 0.000000;
    759.0 0.000135 0.000053 0.000000;
    760.0 0.000126 0.000050 0.000000;
    761.0 0.000118 0.000046 0.000000;
    762.0 0.000110 0.000043 0.000000;
    763.0 0.000103 0.000041 0.000000;
    764.0 0.000096 0.000038 0.000000;
    765.0 0.000090 0.000036 0.000000;
    766.0 0.000084 0.000033 0.000000;
    767.0 0.000079 0.000031 0.000000;
    768.0 0.000074 0.000029 0.000000;
    769.0 0.000069 0.000027 0.000000;
    770.0 0.000065 0.000025 0.000000;
    771.0 0.000060 0.000024 0.000000;
    772.0 0.000056 0.000022 0.000000;
    773.0 0.000053 0.000021 0.000000;
    774.0 0.000049 0.000020 0.000000;
    775.0 0.000046 0.000018 0.000000;
    776.0 0.000043 0.000017 0.000000;
    777.0 0.000041 0.000016 0.000000;
    778.0 0.000038 0.000015 0.000000;
    779.0 0.000036 0.000014 0.000000;
    780.0 0.000033 0.000013 0.000000;
    ];


cmf = cmf1nm(1:10:360,:);


% test plot
if 0
    clf
    plot(cmf(:,1),cmf(:,2),'Color','r'); hold;
    plot(cmf(:,1),cmf(:,3),'Color','g');
    plot(cmf(:,1),cmf(:,4),'Color','b');
    
    plot(cmf(:,1),s.*cmf(:,2),'Color','c');
    plot(cmf(:,1),s.*cmf(:,3),'Color','m');
    plot(cmf(:,1),s.*cmf(:,4),'Color','y');
    
    plot(cmf(:,1),s,'Color','k');
end



X = sum(s.*cmf(:,2));
Y = sum(s.*cmf(:,3));
Z = sum(s.*cmf(:,4));
XYZ = X + Y + Z;
xx = X/XYZ;
yy = Y/XYZ;
zz = Z/XYZ;

end